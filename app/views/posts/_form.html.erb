<%= form_with(model: post, local: true) do |form| %>
  <% if post.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(post.errors.count, "error") %> prohibited this post from being saved:</h2>

      <ul>
      <% post.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

<div class="row">
  <div class="col-xs-12 col-sm-10 offset-sm-1">
    <div class="jumbotron" id="postJumbotron">
      <h2><%= title %></h2>
      <hr>
      <div class="form-group">
        <%= form.label :title %>
        <%= form.text_field :title, id: :post_title, class: 'form-control', placeholder: 'Your post\'s title' %>
      </div>

      <div class="form-group">
        <%= form.label :summary %>
        <%= form.text_field :summary, id: :post_summary, class: 'form-control', placeholder: 'A quick summary for your post' %>
      </div>
      
      
      <div class="form-group">
        <%= form.label :content %>
        <%= form.trix_editor :content, id: :post_content, placeholder: 'Write your post\'s stuff here' %>
      </div>

      <div class="row">
        <div class="col-sm-12">
          <div class="card">
            <h5 class="card-header">Post Preview</h5>
            <div class="card-body">
              <div id="contentPreview">The post will appear here...</div>
            </div>
          </div>
        </div>
      </div>
      <br>

      <div class="row">
        <div class="col-xs-12 col-sm-4 dropdown">
          <label for="tagInput">Post Tags</label>
          <input id="tagInput" type="text" class="form-control" placeholder="Tag Name" data-toggle="dropdown">
          <span class="dropdown-menu" id="dropdownMenu">
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" data-toggle="modal" data-target="#createNewTagModal">Create new tag...</a>
          </span>
        </div>
        <div class="col-xs-12 col-sm-8">
          <div id="tags"></div>
        </div>
      </div>
      <hr>
      <div>
        <%= form.submit class: 'btn btn-info'%>
      </div>

      <%= hidden_field_tag :post_tags,"", name: "post_tags" %>
    </div>
  </div>
</div>  
<% end %>

<%= render 'new_tag_modal' %>

<script>
  const initialTags = <%= raw @initial_tags %>;
  const currentTags = <%= raw @current_tags %>;
</script>
<%= javascript_include_tag 'post_tags' %>